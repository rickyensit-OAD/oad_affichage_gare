<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>OAD – Affichage Gare</title>

<style>
/* ===== BASE ===== */
body {
  margin: 0;
  background: #0a1f33;
  font-family: "Segoe UI", Arial, sans-serif;
  color: white;
}

/* ===== HEADER ===== */
header {
  background: #062033;
  padding: 20px 30px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 4px solid #00c8ff;
}

header h1 {
  margin: 0;
  font-size: 36px;
}

#clock {
  font-size: 32px;
  font-weight: bold;
}

/* ===== MAIN ===== */
.main {
  display: flex;
  height: calc(100vh - 100px);
}

/* ===== TABLE ===== */
.table-container {
  width: 70%;
  padding: 20px;
  overflow: hidden;
}

table {
  width: 100%;
  border-collapse: collapse;
  font-size: 24px;
}

th {
  background: #0d304a;
  padding: 14px;
  text-align: left;
  border-bottom: 3px solid #00c8ff;
}

td {
  padding: 16px;
  border-bottom: 1px solid #1e405a;
}

/* ===== STATUTS ===== */
.statut-ok {
  color: #4CAF50;
  font-weight: bold;
}

.statut-embarquement {
  color: #FFC107;
  font-weight: bold;
}

.statut-retard {
  color: #F44336;
  font-weight: bold;
}

.statut-parti {
  color: #64B5F6;
  font-weight: bold;
}

/* ===== PUB ===== */
.pub {
  width: 30%;
  background: black;
  display: flex;
  align-items: center;
  justify-content: center;
}

.pub img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}
</style>
</head>

<body>

<header>
  <h1>OAD – Affichage Gare</h1>
  <div id="clock">--:--</div>
</header>

<div class="main">
  <div class="table-container">
    <table>
      <thead>
        <tr>
          <th>Numéro</th>
          <th>Destination</th>
          <th>Départ</th>
          <th>Arrivée</th>
          <th>Statut</th>
        </tr>
      </thead>
      <tbody id="tableBody">
        <!-- données -->
      </tbody>
    </table>
  </div>

  <div class="pub">
    <img src="https://images.unsplash.com/photo-1509749837427-ac94a2553d0e" alt="Bus">
  </div>
</div>

<script>
/* ===== CONFIG API ===== */
const API_URL = "https://script.google.com/macros/s/AKfycbzoRceg8FEEolVN3RQ8bhZGmrLtzu6d2CSJrbGU4tXbU6qztmum7MZpdQLz1SiIqIdc/exec";

/* ===== FORMAT HEURE ===== */
function formatHeure(dateString) {
  if (!dateString) return "--:--";
  const d = new Date(dateString);
  return d.toLocaleTimeString("fr-FR", {
    hour: "2-digit",
    minute: "2-digit"
  });
}

/* ===== STATUT CLASS ===== */
function getStatutClass(statut) {
  if (!statut) return "";
  statut = statut.toLowerCase();

  if (statut.includes("heure")) return "statut-ok";
  if (statut.includes("embarquement")) return "statut-embarquement";
  if (statut.includes("retard")) return "statut-retard";
  if (statut.includes("parti")) return "statut-parti";

  return "";
}

/* ===== LOAD DATA ===== */
async function loadData() {
  try {
    const res = await fetch(API_URL);
    const data = await res.json();

    const tbody = document.getElementById("tableBody");
    tbody.innerHTML = "";

    data.forEach(row => {
      const tr = document.createElement("tr");

      tr.innerHTML = `
        <td>${row.numero || ""}</td>
        <td>${row.destination || ""}</td>
        <td>${formatHeure(row.depart)}</td>
        <td>${formatHeure(row.arrivee)}</td>
        <td class="${getStatutClass(row.statut)}">${row.statut || ""}</td>
      `;

      tbody.appendChild(tr);
    });
  } catch (e) {
    console.error("Erreur chargement données", e);
  }
}

/* ===== CLOCK ===== */
setInterval(() => {
  document.getElementById("clock").innerText =
    new Date().toLocaleTimeString("fr-FR");
}, 1000);

/* ===== INIT ===== */
loadData();
setInterval(loadData, 30000);
</script>

</body>
</html>
